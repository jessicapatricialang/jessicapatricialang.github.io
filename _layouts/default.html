<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">
<title>{% if page.title %}{{ page.title | escape }} | {% endif %}{{ site.title | escape }}</title>
<meta charset="{{ site.encoding }}">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="{{ page.author | default: site.author | escape }}">
<meta name="generator" content="Jekyll v{{ jekyll.version }}">
<link rel="canonical" href="{{ page.url | absolute_url }}">
{% if site.show_frame %}
<link rel="stylesheet" href="{{ "/assets/css/frame.css" | relative_url }}">
{% else %}
<link rel="stylesheet" href="{{ "/assets/css/index.css" | relative_url }}">
{% endif %}
{% if site.plugins contains "jekyll-feed" %}<link rel="alternate" href="{{ site.feed.path | default: "/feed.xml" | relative_url }}" type="application/atom+xml" title="{{ site.title }}">{% endif %}
{% if page.mathjax or site.mathjax %}
<link rel="stylesheet" href="{{ "/assets/katex/katex.min.css" | relative_url }}">
<script defer src="{{ "/assets/katex/katex.min.js" | relative_url }}"></script>
<script defer src="{{ "/assets/katex/contrib/auto-render.min.js" | relative_url }}" onload="renderMathInElement(document.body)"></script>
{% endif %}
{% if site.comments.disqus_shortname and page.layout == "post" %}<script src="//{{ site.comments.disqus_shortname }}.disqus.com/embed.js" async></script>{% endif %}
{% if site.comments.isso_domain and page.layout == "post" %}<script data-isso="http://{{ site.comments.isso_domain }}" src="//{{ site.comments.isso_domain }}/js/embed.min.js"></script>{% endif %}
{% if site.show_sidebar or site.sidebar %}{% include sidebar.html %}{% endif %}

{% if site.navigation %}
  {% assign pages = site.navigation %}
{% else %}
  {% assign pages = site.pages | where_exp: "item", "item.title and item.sitemap != false" | sort: "order" %}
{% endif %}

<header>
  <a href="{{ "/" | relative_url }}" class="title">{{ site.title | escape }}</a>
  {% include menu.html menu=pages %}
</header>

{{ content }}

{% if site.external %}
<footer>
  <div>{{ site.description | default: site.title }}</div>
  {% include menu.html menu=site.external %}
</footer>
{% endif %}

  <style>
      /* Ensure no borders or outlines for the icons */
      .icon {
        border: none
        outline: none
        box-shadow: none
      }

      #theme-toggle {
        border: none
        outline: none
        background: transparent
        cursor: pointer
        padding: 0
      }

      #theme-toggle svg {
        border: none
        outline: none
        box-shadow: none
      }

      #theme-toggle img {
        border: none
        outline: none
      }

      /* Using Sass variables for light and dark modes */
      html[data-theme='dark'] {
        background-color: $dark
        color: $light
      }

      html[data-theme='light'] {
        background-color: $light
        color: $dark
      }

      html {
        transition: background-color 0.3s, color 0.3s
      }
    </style>
  </head>
  <body>
    <header>
      <a href="{{ '/' | relative_url }}" class="title">{{ site.title | escape }}</a>
      {% include menu.html menu=pages %}
    </header>

    <div class="content">
      {{ content }}
    </div>

    {% if site.external %}
      <footer>
        <div>{{ site.description | default: site.title }}</div>
        {% include menu.html menu=site.external %}
      </footer>
    {% endif %}

    <!-- Theme Toggle JavaScript -->
    <script>
      // Retrieve the saved theme or system preference
      const savedTheme = localStorage.getItem('theme')
      const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches
      const initialTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light')

      // Apply the initial theme
      document.documentElement.setAttribute('data-theme', initialTheme)

      // Update the button's icon based on the theme
      const themeIcon = document.getElementById('theme-icon')
      themeIcon.textContent = initialTheme === 'dark' ? 'ðŸŒ™' : 'ðŸŒž'

      // Event listener for theme toggle button
      document.getElementById('theme-toggle').addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme')
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark'

        // Apply the new theme
        document.documentElement.setAttribute('data-theme', newTheme)

        // Update the button icon
        themeIcon.textContent = newTheme === 'dark' ? 'ðŸŒ™' : 'ðŸŒž'

        // Save the user's preference
        localStorage.setItem('theme', newTheme)
      })
    </script>
  </body>
</html>
